import{r as o,j as e,G as I,T as A,b as y}from"./index-B51ItZ5h.js";import{u}from"./useQuery-DhzND272.js";import{C as r}from"./Card-tTIaziEs.js";import{B as f}from"./Button-CDIPLpLJ.js";import{I as j}from"./input-CPPgFB4q.js";import{B as N}from"./Badge-CFKe1Fd1.js";import{a as b}from"./api-DLjschmT.js";import{L as E,P as B,C as G,a as V,b as F,c as O,d as $,B as _,A as q,p as H,e as K,f as U}from"./index-DYXL751b.js";import{D as W}from"./download-CZPgOUBS.js";import{R as Y}from"./refresh-cw-BiiooO2n.js";import{D as z}from"./dollar-sign-Cpv4PdFW.js";import{C as Q}from"./clock-D1dtIjEg.js";import{A as J}from"./alert-triangle-BumWFkfF.js";G.register(V,F,O,$,_,q,H,K,U);function xe(){var h,p;const[n,v]=o.useState(1),[d,k]=o.useState("30d"),[R,w]=o.useState(""),{data:s,isLoading:X,refetch:C}=u({queryKey:["player-behavior",n,d],queryFn:()=>b.get(y.PLAYERS.BEHAVIOR(n)),enabled:!!n}),{data:i}=u({queryKey:["player-overview"],queryFn:()=>b.get(y.PLAYERS.OVERVIEW)}),t=s!=null&&s.data?{playerId:s.data.playerId,username:s.data.username,email:`${s.data.username}@example.com`,registrationDate:new Date().toISOString(),lastLoginDate:new Date().toISOString(),totalDeposits:Math.floor(Math.random()*1e4),totalBets:Math.floor(Math.random()*5e4),totalWins:Math.floor(Math.random()*25e3),totalGamesPlayed:Math.floor(Math.random()*500),favoriteGameTypes:((h=s.data.gamePreferences)==null?void 0:h.preferredGameTypes)||["Action","RPG"],riskLevel:Math.floor(s.data.riskScore/25)+1,vipLevel:Math.floor(Math.random()*5),averageSessionDuration:45,sessionsCount:Math.floor(Math.random()*100),conversionRate:Math.random()*.3,lifetimeValue:Math.floor(Math.random()*5e3),churnRisk:Math.random()*.5,recommendationEngagement:{totalRecommendations:Math.floor(Math.random()*100),clickedRecommendations:Math.floor(Math.random()*50),playedRecommendations:Math.floor(Math.random()*25),ctr:Math.random()*.4,conversionRate:Math.random()*.2},gamePreferences:[{gameType:"Action",playCount:45,totalBets:2500,winRate:.65},{gameType:"RPG",playCount:32,totalBets:1800,winRate:.58},{gameType:"Adventure",playCount:28,totalBets:1200,winRate:.72}],activityTrend:Array.from({length:30},(a,l)=>({date:new Date(Date.now()-(29-l)*24*60*60*1e3).toISOString(),sessions:Math.floor(Math.random()*10),bets:Math.floor(Math.random()*1e3),wins:Math.floor(Math.random()*500)}))}:void 0,c=(p=i==null?void 0:i.data)!=null&&p.playerSegments?Object.entries(i.data.playerSegments).map(([a,l])=>({segmentId:a.toLowerCase(),segmentName:a,description:`${a} players based on engagement and value`,playerCount:l,averageLTV:Math.floor(Math.random()*2e3)+500,churnRate:Math.random()*.3,characteristics:[`${a} engagement`,"Active players","Regular sessions"]})):[],M=a=>a<=2?"bg-green-100 text-green-800":a<=4?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",S=a=>a<=2?"Low Risk":a<=4?"Medium Risk":"High Risk",D=a=>a===0?"bg-gray-100 text-gray-800":a<=2?"bg-blue-100 text-blue-800":a<=4?"bg-purple-100 text-purple-800":"bg-yellow-100 text-yellow-800",P=a=>a===0?"Standard":a<=2?"Bronze":a<=4?"Silver":"Gold",m=a=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a),T=a=>{const l=Math.floor(a/60),L=Math.floor(a%60);return`${l}h ${L}m`},x=t?{labels:t.activityTrend.map(a=>new Date(a.date).toLocaleDateString()),datasets:[{label:"Sessions",data:t.activityTrend.map(a=>a.sessions),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",yAxisID:"y"},{label:"Total Bets ($)",data:t.activityTrend.map(a=>a.bets),borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",yAxisID:"y1"}]}:null,g=t?{labels:t.gamePreferences.map(a=>a.gameType),datasets:[{label:"Play Count",data:t.gamePreferences.map(a=>a.playCount),backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)","rgba(139, 92, 246, 0.8)"]}]}:null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Player Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Deep insights into player behavior and engagement"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(f,{variant:"outline",icon:e.jsx(W,{className:"h-4 w-4"}),children:"Export Report"}),e.jsx(f,{onClick:()=>C(),variant:"outline",icon:e.jsx(Y,{className:"h-4 w-4"}),children:"Refresh"})]})]}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Player ID"}),e.jsx(j,{type:"number",value:n,onChange:a=>v(Number(a.target.value)),placeholder:"Enter player ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Time Range"}),e.jsxs("select",{value:d,onChange:a=>k(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"1y",children:"Last year"})]})]}),e.jsx(j,{placeholder:"Search players...",value:R,onChange:a=>w(a.target.value)})]})}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:t.username}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.email}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Registered: ",new Date(t.registrationDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(N,{className:M(t.riskLevel),children:S(t.riskLevel)}),e.jsx(N,{className:D(t.vipLevel),children:P(t.vipLevel)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(z,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Lifetime Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:m(t.lifetimeValue)})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(I,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Games Played"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.totalGamesPlayed.toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Avg Session"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:T(t.averageSessionDuration)})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Rec CTR"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[(t.recommendationEngagement.ctr*100).toFixed(1),"%"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Activity Trend"}),x&&e.jsx(E,{data:x,options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:{x:{display:!0,title:{display:!0,text:"Date"}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Sessions"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Bets ($)"},grid:{drawOnChartArea:!1}}}}})]}),e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Game Preferences"}),g&&e.jsx(B,{data:g,options:{responsive:!0,plugins:{legend:{position:"bottom"}}}})]})]}),e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recommendation Engagement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:t.recommendationEngagement.totalRecommendations}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Shown"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-green-600",children:t.recommendationEngagement.clickedRecommendations}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Clicked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:t.recommendationEngagement.playedRecommendations}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Played"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:[(t.recommendationEngagement.conversionRate*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Conversion"})]})]})]}),t.churnRisk>.7&&e.jsx(r,{className:"p-6 border-red-200 bg-red-50 dark:bg-red-900/20",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-200",children:"High Churn Risk Detected"}),e.jsxs("p",{className:"text-red-700 dark:text-red-300",children:["This player has a ",(t.churnRisk*100).toFixed(1),"% probability of churning. Consider targeted retention campaigns."]})]})]})})]}),c&&e.jsxs(r,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Player Segments"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.map(a=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-lg mb-2",children:a.segmentName}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-3",children:a.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Players:"}),e.jsx("span",{className:"font-medium",children:a.playerCount.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Avg LTV:"}),e.jsx("span",{className:"font-medium",children:m(a.averageLTV)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Churn Rate:"}),e.jsxs("span",{className:"font-medium",children:[(a.churnRate*100).toFixed(1),"%"]})]})]})]},a.segmentId))})]})]})}export{xe as default};
//# sourceMappingURL=PlayerAnalytics-Vjm0pI-M.js.map
