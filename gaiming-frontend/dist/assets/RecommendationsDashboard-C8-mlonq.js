import{r as l,k as _,j as e,T as A,b as y}from"./index-B51ItZ5h.js";import{u as E}from"./useQuery-DhzND272.js";import{u as D}from"./useMutation-B0zsV7dG.js";import{C as r}from"./Card-tTIaziEs.js";import{B as o}from"./Button-CDIPLpLJ.js";import{I as j}from"./input-CPPgFB4q.js";import{B as Y}from"./Badge-CFKe1Fd1.js";import{a as h}from"./api-DLjschmT.js";import{R as B}from"./refresh-cw-BiiooO2n.js";import{T as J}from"./trending-up-CcBaz28r.js";import{P as G}from"./play-BG1br7nY.js";import{S as V}from"./star-Bty2TuTv.js";import{D as W}from"./download-CZPgOUBS.js";import{E as X}from"./eye-BCxAWvGz.js";import{C as Z}from"./clock-D1dtIjEg.js";function ue(){var C,w,S,R;const[c,M]=l.useState(1),[N,$]=l.useState("hybrid"),[v,L]=l.useState(10),[b,U]=l.useState("lobby"),[d,q]=l.useState(""),[m,F]=l.useState(""),n=_(),{data:t,isLoading:ee}=E({queryKey:["recommendation-stats"],queryFn:()=>h.get(y.RECOMMENDATIONS.ANALYTICS),refetchInterval:3e4}),i=t!=null&&t.data?{totalRecommendations:t.data.totalRecommendations,totalClicks:t.data.totalClicks,totalPlays:t.data.totalPlays,clickThroughRate:t.data.clickThroughRate/100,conversionRate:t.data.conversionRate/100,averageScore:t.data.averageScore,activeAlgorithms:((C=t.data.algorithmPerformance)==null?void 0:C.map(a=>a.algorithm))||[],topPerformingGames:((w=t.data.topPerformingGames)==null?void 0:w.map(a=>({gameId:a.gameId,gameName:a.gameName,clicks:a.clicks,plays:a.plays,ctr:a.clicks>0?a.plays/a.clicks:0})))||[]}:void 0,{data:p,isLoading:K,refetch:O}=E({queryKey:["recommendations",c,m,d],queryFn:()=>{let a=`${y.RECOMMENDATIONS.BASE}?playerId=${c}`;return m&&(a+=`&algorithm=${m}`),d&&(a+=`&search=${d}`),h.get(a)}}),u=((R=(S=p==null?void 0:p.data)==null?void 0:S.items)==null?void 0:R.map(a=>{var s,g,I,P,T;return{id:a.id,playerId:a.playerId,gameId:a.gameId,game:{gameId:((s=a.game)==null?void 0:s.gameId)||a.gameId,gameName:((g=a.game)==null?void 0:g.gameName)||`Game ${a.gameId}`,gameTypeName:((I=a.game)==null?void 0:I.gameTypeName)||"Unknown",providerName:((P=a.game)==null?void 0:P.providerName)||"Unknown",imageUrl:(T=a.game)==null?void 0:T.imageUrl},score:a.score,algorithm:a.algorithm,reason:a.reason,position:a.position,category:a.category,context:a.context,isClicked:a.isClicked,isPlayed:a.isPlayed,generatedDate:a.generatedDate,variant:a.variant}}))||[],f=D({mutationFn:a=>{const s=new URLSearchParams({playerId:a.playerId.toString(),algorithm:a.algorithm,context:a.context,count:a.count.toString()});return h.post(`${y.RECOMMENDATIONS.GENERATE}?${s}`)},onSuccess:()=>{n.invalidateQueries({queryKey:["recommendations"]}),n.invalidateQueries({queryKey:["recommendation-stats"]})}}),Q=D({mutationFn:({recommendationId:a,interactionType:s})=>{const g=s==="click"?`/Recommendations/${a}/click`:`/Recommendations/${a}/play`;return h.post(g)},onSuccess:()=>{n.invalidateQueries({queryKey:["recommendations"]}),n.invalidateQueries({queryKey:["recommendation-stats"]})}}),H=()=>{f.mutate({playerId:c,algorithm:N,count:v,context:b})},k=(a,s)=>{Q.mutate({recommendationId:a,interactionType:s})},z=a=>({collaborative:"bg-blue-100 text-blue-800","content-based":"bg-green-100 text-green-800",hybrid:"bg-purple-100 text-purple-800",bandit:"bg-orange-100 text-orange-800",popularity:"bg-gray-100 text-gray-800"})[a]||"bg-gray-100 text-gray-800",x=a=>(a*100).toFixed(1)+"%";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Game Recommendations Dashboard"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Real-time recommendation engine management and analytics"})]}),e.jsx(o,{onClick:()=>{O(),n.invalidateQueries({queryKey:["recommendation-stats"]})},variant:"outline",icon:e.jsx(B,{className:"h-4 w-4"}),children:"Refresh Data"})]}),i&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(A,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Total Recommendations"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:i.totalRecommendations.toLocaleString()})]})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(J,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Click-Through Rate"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x(i.clickThroughRate)})]})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(G,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Conversion Rate"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x(i.conversionRate)})]})]})}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-8 w-8 text-yellow-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Average Score"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:x(i.averageScore)})]})]})})]}),e.jsxs(r,{className:"p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Generate New Recommendations"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Player ID"}),e.jsx(j,{type:"number",value:c,onChange:a=>M(Number(a.target.value)),placeholder:"Enter player ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Algorithm"}),e.jsxs("select",{value:N,onChange:a=>$(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"hybrid",children:"Hybrid"}),e.jsx("option",{value:"collaborative",children:"Collaborative Filtering"}),e.jsx("option",{value:"content-based",children:"Content-Based"}),e.jsx("option",{value:"bandit",children:"Multi-Armed Bandit"}),e.jsx("option",{value:"popularity",children:"Popularity-Based"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Count"}),e.jsx(j,{type:"number",value:v,onChange:a=>L(Number(a.target.value)),min:1,max:50})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Context"}),e.jsxs("select",{value:b,onChange:a=>U(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"lobby",children:"Lobby"}),e.jsx("option",{value:"post-game",children:"Post-Game"}),e.jsx("option",{value:"profile",children:"Profile"}),e.jsx("option",{value:"homepage",children:"Homepage"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx(o,{onClick:H,loading:f.isPending,className:"w-full",children:"Generate"})})]})]}),e.jsx(r,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(j,{placeholder:"Search games...",value:d,onChange:a=>q(a.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{value:m,onChange:a=>F(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"All Algorithms"}),e.jsx("option",{value:"hybrid",children:"Hybrid"}),e.jsx("option",{value:"collaborative",children:"Collaborative"}),e.jsx("option",{value:"content-based",children:"Content-Based"}),e.jsx("option",{value:"bandit",children:"Bandit"}),e.jsx("option",{value:"popularity",children:"Popularity"})]})})]})}),e.jsxs(r,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Recent Recommendations"}),e.jsx(o,{variant:"outline",icon:e.jsx(W,{className:"h-4 w-4"}),children:"Export Data"})]}),K?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(B,{className:"h-8 w-8 animate-spin text-gray-400"})}):u&&u.length>0?e.jsx("div",{className:"space-y-4",children:u.map(a=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:bg-gray-50 dark:hover:bg-gray-800 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[a.game.imageUrl&&e.jsx("img",{src:a.game.imageUrl,alt:a.game.gameName,className:"w-16 h-16 rounded-lg object-cover"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg",children:a.game.gameName}),e.jsxs("p",{className:"text-gray-600 dark:text-gray-400",children:[a.game.gameTypeName," â€¢ ",a.game.providerName]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a.reason})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Score"}),e.jsx("p",{className:"font-semibold",children:x(a.score)})]}),e.jsx(Y,{className:z(a.algorithm),children:a.algorithm}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(o,{size:"sm",variant:a.isClicked?"default":"outline",onClick:()=>k(a.id,"click"),disabled:a.isClicked,children:e.jsx(X,{className:"h-4 w-4"})}),e.jsx(o,{size:"sm",variant:a.isPlayed?"default":"outline",onClick:()=>k(a.id,"play"),disabled:a.isPlayed,children:e.jsx(G,{className:"h-4 w-4"})})]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Position: #",a.position]}),e.jsxs("span",{children:["Context: ",a.context]}),e.jsxs("span",{children:["Category: ",a.category]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"h-4 w-4"}),e.jsx("span",{children:new Date(a.generatedDate).toLocaleString()})]})]})]},a.id))}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No recommendations found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Generate some recommendations to get started."})]})]})]})}export{ue as default};
//# sourceMappingURL=RecommendationsDashboard-C8-mlonq.js.map
