import{r as n,j as e,G as P,T as D,b as L}from"./index-BlsT4Di8.js";import{u as m}from"./useQuery-pnymDCL_.js";import{C as a}from"./Card-vncpb8C1.js";import{B as x}from"./Button-SeG07tvq.js";import{I as g}from"./input-DIDSjnMG.js";import{B as h}from"./Badge-DWypyQDT.js";import{a as p}from"./api-DCB3q_mZ.js";import{L as T,P as A,C as E,a as I,b as B,c as F,d as _,B as G,A as V,p as $,e as q,f as M}from"./index-Bn_O97dh.js";import{D as H}from"./download-D6mOS-Wn.js";import{R as K}from"./refresh-cw-qDPeDhiU.js";import{D as O}from"./dollar-sign-DDS47212.js";import{C as U}from"./clock-CPE3ODyA.js";import{A as Y}from"./alert-triangle-B8aR42Ei.js";E.register(I,B,F,_,G,V,$,q,M);function ce(){const[r,y]=n.useState(1),[l,u]=n.useState("30d"),[j,N]=n.useState(""),{data:t,isLoading:z,refetch:f}=m({queryKey:["player-analytics",r,l],queryFn:()=>p.get(`${L.PLAYERS.ANALYTICS(r)}?timeRange=${l}`),enabled:!!r}),{data:i,isLoading:Q}=m({queryKey:["player-segments"],queryFn:()=>p.get("/analytics/player-segments")}),b=s=>s<=2?"bg-green-100 text-green-800":s<=4?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800",v=s=>s<=2?"Low Risk":s<=4?"Medium Risk":"High Risk",k=s=>s===0?"bg-gray-100 text-gray-800":s<=2?"bg-blue-100 text-blue-800":s<=4?"bg-purple-100 text-purple-800":"bg-yellow-100 text-yellow-800",C=s=>s===0?"Standard":s<=2?"Bronze":s<=4?"Silver":"Gold",d=s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),w=s=>{const R=Math.floor(s/60),S=Math.floor(s%60);return`${R}h ${S}m`},c=t?{labels:t.activityTrend.map(s=>new Date(s.date).toLocaleDateString()),datasets:[{label:"Sessions",data:t.activityTrend.map(s=>s.sessions),borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",yAxisID:"y"},{label:"Total Bets ($)",data:t.activityTrend.map(s=>s.bets),borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",yAxisID:"y1"}]}:null,o=t?{labels:t.gamePreferences.map(s=>s.gameType),datasets:[{label:"Play Count",data:t.gamePreferences.map(s=>s.playCount),backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(239, 68, 68, 0.8)","rgba(139, 92, 246, 0.8)"]}]}:null;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Player Analytics"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Deep insights into player behavior and engagement"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(x,{variant:"outline",icon:e.jsx(H,{className:"h-4 w-4"}),children:"Export Report"}),e.jsx(x,{onClick:()=>f(),variant:"outline",icon:e.jsx(K,{className:"h-4 w-4"}),children:"Refresh"})]})]}),e.jsx(a,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Player ID"}),e.jsx(g,{type:"number",value:r,onChange:s=>y(Number(s.target.value)),placeholder:"Enter player ID"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Time Range"}),e.jsxs("select",{value:l,onChange:s=>u(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"7d",children:"Last 7 days"}),e.jsx("option",{value:"30d",children:"Last 30 days"}),e.jsx("option",{value:"90d",children:"Last 90 days"}),e.jsx("option",{value:"1y",children:"Last year"})]})]}),e.jsx(g,{placeholder:"Search players...",value:j,onChange:s=>N(s.target.value)})]})}),t&&e.jsxs(e.Fragment,{children:[e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:t.username}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:t.email}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Registered: ",new Date(t.registrationDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(h,{className:b(t.riskLevel),children:v(t.riskLevel)}),e.jsx(h,{className:k(t.vipLevel),children:C(t.vipLevel)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(O,{className:"h-8 w-8 text-green-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Lifetime Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:d(t.lifetimeValue)})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(P,{className:"h-8 w-8 text-blue-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Games Played"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t.totalGamesPlayed.toLocaleString()})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-8 w-8 text-purple-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Avg Session"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:w(t.averageSessionDuration)})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(D,{className:"h-8 w-8 text-orange-600"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 dark:text-gray-400",children:"Rec CTR"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:[(t.recommendationEngagement.ctr*100).toFixed(1),"%"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(a,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Activity Trend"}),c&&e.jsx(T,{data:c,options:{responsive:!0,interaction:{mode:"index",intersect:!1},scales:{x:{display:!0,title:{display:!0,text:"Date"}},y:{type:"linear",display:!0,position:"left",title:{display:!0,text:"Sessions"}},y1:{type:"linear",display:!0,position:"right",title:{display:!0,text:"Bets ($)"},grid:{drawOnChartArea:!1}}}}})]}),e.jsxs(a,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Game Preferences"}),o&&e.jsx(A,{data:o,options:{responsive:!0,plugins:{legend:{position:"bottom"}}}})]})]}),e.jsxs(a,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Recommendation Engagement"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:t.recommendationEngagement.totalRecommendations}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Shown"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-green-600",children:t.recommendationEngagement.clickedRecommendations}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Clicked"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-3xl font-bold text-purple-600",children:t.recommendationEngagement.playedRecommendations}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Played"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:[(t.recommendationEngagement.conversionRate*100).toFixed(1),"%"]}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Conversion"})]})]})]}),t.churnRisk>.7&&e.jsx(a,{className:"p-6 border-red-200 bg-red-50 dark:bg-red-900/20",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{className:"ml-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-red-800 dark:text-red-200",children:"High Churn Risk Detected"}),e.jsxs("p",{className:"text-red-700 dark:text-red-300",children:["This player has a ",(t.churnRisk*100).toFixed(1),"% probability of churning. Consider targeted retention campaigns."]})]})]})})]}),i&&e.jsxs(a,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Player Segments"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map(s=>e.jsxs("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-lg mb-2",children:s.segmentName}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm mb-3",children:s.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Players:"}),e.jsx("span",{className:"font-medium",children:s.playerCount.toLocaleString()})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Avg LTV:"}),e.jsx("span",{className:"font-medium",children:d(s.averageLTV)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm",children:"Churn Rate:"}),e.jsxs("span",{className:"font-medium",children:[(s.churnRate*100).toFixed(1),"%"]})]})]})]},s.segmentId))})]})]})}export{ce as default};
//# sourceMappingURL=PlayerAnalytics-BkZbEJWL.js.map
