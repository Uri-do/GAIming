import{c as F,r as m,k as q,j as e,U as L,B as $,F as v,b as n,T as z}from"./index-BlsT4Di8.js";import{u as Q}from"./useQuery-pnymDCL_.js";import{u as o}from"./useMutation-DwmbD4R6.js";import{C as h}from"./Card-vncpb8C1.js";import{B as r}from"./Button-SeG07tvq.js";import{I as U}from"./input-DIDSjnMG.js";import{B as y}from"./Badge-DWypyQDT.js";import{a as i}from"./api-DCB3q_mZ.js";import{g as _}from"./index-Bn_O97dh.js";import{P as G}from"./plus-C-5Yefao.js";import{R as b}from"./refresh-cw-qDPeDhiU.js";import{E as K}from"./eye-CJjTvcwI.js";import{P as S}from"./play-DPBVfAWw.js";import{P as w}from"./pause-CPciK6gb.js";import{C as O}from"./calendar-iT_bV4Am.js";import{P as X}from"./pen-square-61wcVzYP.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=F("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);function xe(){const[t,g]=m.useState(null),[,j]=m.useState(!1),[l,k]=m.useState(""),[c,E]=m.useState(""),d=q(),{data:x,isLoading:T,refetch:P}=Q({queryKey:["ab-experiments",l,c],queryFn:()=>{let s=n.AB_TESTING.EXPERIMENTS;const a=new URLSearchParams;return l&&a.append("status",l),c&&a.append("search",c),a.toString()&&(s+=`?${a.toString()}`),i.get(s)},refetchInterval:3e4}),p=o({mutationFn:s=>i.post(`${n.AB_TESTING.BASE}/${s}/start`),onSuccess:()=>{d.invalidateQueries({queryKey:["ab-experiments"]})}}),f=o({mutationFn:s=>i.post(`${n.AB_TESTING.BASE}/${s}/pause`),onSuccess:()=>{d.invalidateQueries({queryKey:["ab-experiments"]})}}),N=o({mutationFn:s=>i.post(`${n.AB_TESTING.BASE}/${s}/stop`),onSuccess:()=>{d.invalidateQueries({queryKey:["ab-experiments"]})}}),D=o({mutationFn:s=>i.post(n.AB_TESTING.EXPERIMENTS,s),onSuccess:()=>{d.invalidateQueries({queryKey:["ab-experiments"]}),j(!1)}}),A=()=>{console.log("Create experiment:",D)},B=s=>{switch(s){case"running":return"bg-green-100 text-green-800";case"completed":return"bg-blue-100 text-blue-800";case"paused":return"bg-yellow-100 text-yellow-800";case"cancelled":return"bg-red-100 text-red-800";case"draft":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},I=s=>{switch(s){case"running":return e.jsx(S,{className:"h-4 w-4"});case"completed":return e.jsx(z,{className:"h-4 w-4"});case"paused":return e.jsx(w,{className:"h-4 w-4"});case"cancelled":return e.jsx(C,{className:"h-4 w-4"});case"draft":return e.jsx(X,{className:"h-4 w-4"});default:return e.jsx(v,{className:"h-4 w-4"})}},u=s=>(s*100).toFixed(2)+"%";console.log("Utils available:",{formatCurrency:s=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(s),formatDuration:s=>{const a=Math.floor(s/60),M=Math.floor(s%60);return`${a}h ${M}m`},handleCreateExperiment:A});const R=s=>({labels:s.variants.map(a=>a.name),datasets:[{label:"Conversion Rate (%)",data:s.variants.map(()=>Math.random()*10+5),backgroundColor:"rgba(59, 130, 246, 0.8)"},{label:"Click-Through Rate (%)",data:s.variants.map(()=>Math.random()*15+10),backgroundColor:"rgba(16, 185, 129, 0.8)"}]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"A/B Testing Management"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Design, run, and analyze recommendation algorithm experiments"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx(r,{onClick:()=>j(!0),icon:e.jsx(G,{className:"h-4 w-4"}),children:"New Experiment"}),e.jsx(r,{onClick:()=>P(),variant:"outline",icon:e.jsx(b,{className:"h-4 w-4"}),children:"Refresh"})]})]}),e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(U,{placeholder:"Search experiments...",value:c,onChange:s=>E(s.target.value)})}),e.jsx("div",{className:"w-full md:w-48",children:e.jsxs("select",{value:l,onChange:s=>k(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md text-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"running",children:"Running"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})})]})}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:T?e.jsx("div",{className:"col-span-2 flex items-center justify-center py-12",children:e.jsx(b,{className:"h-8 w-8 animate-spin text-gray-400"})}):x&&x.length>0?x.map(s=>e.jsxs(h,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[I(s.status),e.jsx("h3",{className:"text-lg font-semibold",children:s.name})]}),e.jsx(y,{className:B(s.status),children:s.status})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(r,{size:"sm",variant:"outline",onClick:()=>g(s),children:e.jsx(K,{className:"h-4 w-4"})}),s.status==="draft"&&e.jsx(r,{size:"sm",onClick:()=>p.mutate(s.id),loading:p.isPending,children:e.jsx(S,{className:"h-4 w-4"})}),s.status==="running"&&e.jsxs(e.Fragment,{children:[e.jsx(r,{size:"sm",variant:"outline",onClick:()=>f.mutate(s.id),loading:f.isPending,children:e.jsx(w,{className:"h-4 w-4"})}),e.jsx(r,{size:"sm",variant:"destructive",onClick:()=>N.mutate(s.id),loading:N.isPending,children:e.jsx(C,{className:"h-4 w-4"})})]})]})]}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Algorithm"}),e.jsx("p",{className:"font-medium",children:s.algorithm})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Traffic"}),e.jsxs("p",{className:"font-medium",children:[s.trafficAllocation,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Participants"}),e.jsx("p",{className:"font-medium",children:s.metrics.totalParticipants.toLocaleString()})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Conversion Rate"}),e.jsx("p",{className:"font-medium",children:u(s.metrics.conversionRate)})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsxs("span",{children:["Started: ",new Date(s.startDate).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsxs("span",{children:[s.variants.length," variants"]})]})]}),s.status==="running"&&s.metrics.statisticalSignificance>0&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 dark:bg-blue-900/20 rounded-md",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{className:"h-4 w-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-800 dark:text-blue-200",children:["Statistical Significance: ",u(s.metrics.statisticalSignificance)]})]})})]},s.id)):e.jsxs("div",{className:"col-span-2 text-center py-12",children:[e.jsx(v,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-2",children:"No experiments found"}),e.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:"Create your first A/B test experiment to get started."})]})}),t&&e.jsxs(h,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold",children:t.name}),e.jsx(r,{variant:"outline",onClick:()=>g(null),children:"Close"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Experiment Details"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Description"}),e.jsx("p",{children:t.description})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Algorithm"}),e.jsx("p",{className:"font-medium",children:t.algorithm})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Traffic Allocation"}),e.jsxs("p",{className:"font-medium",children:[t.trafficAllocation,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-500",children:"Duration"}),e.jsxs("p",{className:"font-medium",children:[new Date(t.startDate).toLocaleDateString()," -",t.endDate?new Date(t.endDate).toLocaleDateString():"Ongoing"]})]})]}),e.jsx("h4",{className:"text-md font-semibold mt-6 mb-3",children:"Variants"}),e.jsx("div",{className:"space-y-2",children:t.variants.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 dark:border-gray-700 rounded-md",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:s.description})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[s.allocation,"%"]}),s.isControl&&e.jsx(y,{variant:"outline",className:"text-xs",children:"Control"})]})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Performance Comparison"}),e.jsx(_,{data:R(t),options:{responsive:!0,plugins:{legend:{position:"top"}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Rate (%)"}}}}})]})]}),t.results&&e.jsxs("div",{className:"mt-6 p-4 bg-green-50 dark:bg-green-900/20 rounded-md",children:[e.jsx("h4",{className:"text-lg font-semibold text-green-800 dark:text-green-200 mb-2",children:"Experiment Results"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Winner"}),e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:t.results.winner})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Confidence Level"}),e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:u(t.results.confidenceLevel)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Effect Size"}),e.jsx("p",{className:"font-medium text-green-800 dark:text-green-200",children:t.results.effectSize.toFixed(3)})]})]}),t.results.recommendations.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400 mb-2",children:"Recommendations"}),e.jsx("ul",{className:"list-disc list-inside space-y-1",children:t.results.recommendations.map((s,a)=>e.jsx("li",{className:"text-sm text-green-700 dark:text-green-300",children:s},a))})]})]})]})]})}export{xe as default};
//# sourceMappingURL=ABTestingManagement-Bet2MrCk.js.map
